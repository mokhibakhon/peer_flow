{% extends "base.html" %}

{% block title %}Study Room - Peer Flow{% endblock %}

{% block head %}
<style>
    .video-container {
        aspect-ratio: 16/9;
        background: #1a1a1a;
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
    }
    
    .chat-container {
        height: 400px;
        overflow-y: auto;
    }
    
    .message {
        margin-bottom: 12px;
        padding: 8px 12px;
        border-radius: 8px;
        max-width: 80%;
    }
    
    .message.sent {
        background: var(--color-primary);
        color: white;
        margin-left: auto;
    }
    
    .message.received {
        background: #f3f4f6;
        color: #374151;
    }
</style>
{% endblock %}

{% block content %}
<div class="container mx-auto px-6 py-10">
    <!-- Header -->
    <header class="mb-8 flex items-center justify-between">
        <div>
            <h1 class="text-3xl font-bold">Study Room</h1>
            <p class="text-gray-600">Room: {{ room_slug }}</p>
        </div>
        <div class="flex items-center gap-4">
            <span class="text-sm text-gray-600">
                Connected: <span class="font-medium text-accent">2 participants</span>
            </span>
            <a href="{{ url_for('dashboard') }}" 
               class="bg-gray-100 text-gray-700 px-4 py-2 rounded-md text-sm font-medium hover:bg-gray-200">
                Back to Dashboard
            </a>
        </div>
    </header>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
        <!-- Video Section -->
        <div class="lg:col-span-2 space-y-6">
            <!-- Main Video -->
            <div class="video-container">
                <div class="text-center">
                    <svg class="mx-auto h-12 w-12 text-gray-400 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                    </svg>
                    <p class="text-lg font-medium">Video call not available</p>
                    <p class="text-sm text-gray-400">This is a demo room</p>
                </div>
            </div>

            <!-- Controls -->
            <div class="flex items-center justify-center gap-4">
                <button class="p-3 bg-gray-100 rounded-full hover:bg-gray-200">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"></path>
                    </svg>
                </button>
                
                <button class="p-3 bg-red-500 text-white rounded-full hover:bg-red-600">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
                
                <button class="p-3 bg-gray-100 rounded-full hover:bg-gray-200">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                    </svg>
                </button>
            </div>

            <!-- Challenge Info -->
            <div class="bg-white p-6 rounded-lg border border-gray-200">
                <h3 class="text-lg font-semibold mb-4">Today's Challenge</h3>
                <div class="space-y-3">
                    <div class="flex items-center gap-3">
                        <div class="w-8 h-8 bg-accent rounded-full flex items-center justify-center text-white text-sm font-bold">1</div>
                        <div>
                            <h4 class="font-medium">Day 1: Getting Started</h4>
                            <p class="text-sm text-gray-500">Set up your development environment and create your first project</p>
                        </div>
                    </div>
                    <div class="flex items-center gap-2">
                        <span class="text-sm text-gray-600">Progress:</span>
                        <div class="flex-1 bg-gray-200 h-2 rounded-full">
                            <div class="bg-accent h-2 rounded-full" style="width: 60%"></div>
                        </div>
                        <span class="text-sm font-medium text-accent">60%</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Chat Section -->
        <div class="bg-white rounded-lg border border-gray-200">
            <div class="p-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold">Chat</h3>
                <p class="text-sm text-gray-500">2 participants</p>
            </div>
            
            <div class="chat-container p-4" id="chat-messages">
                <div class="message received">
                    <div class="text-xs text-gray-500 mb-1">Alex Chen</div>
                    <div>Hey! Ready to start today's challenge?</div>
                </div>
                
                <div class="message sent">
                    <div class="text-xs text-gray-300 mb-1">You</div>
                    <div>Absolutely! I've been looking forward to this.</div>
                </div>
                
                <div class="message received">
                    <div class="text-xs text-gray-500 mb-1">Alex Chen</div>
                    <div>Great! I think we should start with setting up the environment. What do you think?</div>
                </div>
            </div>
            
            <div class="p-4 border-t border-gray-200">
                <form class="flex gap-2" onsubmit="sendMessage(event)">
                    <input type="text" id="message-input" 
                           class="flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-primary focus:border-primary"
                           placeholder="Type a message...">
                    <button type="submit" 
                            class="px-4 py-2 bg-primary text-white rounded-md hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary">
                        Send
                    </button>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
    function sendMessage(event) {
        event.preventDefault();
        const input = document.getElementById('message-input');
        const message = input.value.trim();
        
        if (message) {
            const chatMessages = document.getElementById('chat-messages');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message sent';
            messageDiv.innerHTML = `
                <div class="text-xs text-gray-300 mb-1">You</div>
                <div>${message}</div>
            `;
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            input.value = '';
        }
    }
    
    // Auto-scroll chat to bottom
    document.addEventListener('DOMContentLoaded', function() {
        const chatMessages = document.getElementById('chat-messages');
        chatMessages.scrollTop = chatMessages.scrollHeight;
    });
</script>
{% endblock %} 